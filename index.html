<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário com LocalStorage e Google Sheets</title>
</head>
<body>
  <h2>Formulário de Contato</h2>
  <form id="meuFormulario">
    <label>Nome: <input type="text" id="nome" required></label><br>
    <label>Email: <input type="email" id="email" required></label><br>
    <label>Mensagem:<br><textarea id="mensagem" required></textarea></label><br>
    <button type="submit">Enviar</button>
  </form>

  <script>
    const form = document.getElementById('meuFormulario');
    const scriptURL = 'https://script.google.com/macros/s/SEU_ID_AQUI/exec'; // Substitua com a URL gerada

    form.addEventListener('submit', function(event) {
      event.preventDefault();

      const dados = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        mensagem: document.getElementById('mensagem').value
      };

      // Salva no localStorage
      localStorage.setItem('formularioDados', JSON.stringify(dados));

      // Envia para o Google Sheets
      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(dados),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => alert('Dados enviados com sucesso!'))
      .catch(error => alert('Erro ao enviar dados: ' + error.message));
    });
  </script>
</body>
</html>
